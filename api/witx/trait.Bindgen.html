<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Trait for language implementors to use to generate glue code between native WebAssembly signatures and interface types signatures."><title>Bindgen in witx - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-a23c9d150ad85d8b.css" id="mainThemeStyle"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="witx" data-themes="" data-resource-suffix="" data-rustdoc-version="1.72.0-nightly (6162f6f12 2023-07-01)" data-channel="nightly" data-search-js="search-91b58767224854cb.js" data-settings-js="settings-de11bff964e9d4e5.js" data-settings-css="settings-8c76f75bfb6bd192.css" data-theme-light-css="light-0f8c037637f9eb3e.css" data-theme-dark-css="dark-1097f8e92a01e3cf.css" data-theme-ayu-css="ayu-614652228113ac93.css" ><script src="../static.files/storage-59fd9b8ccb335783.js"></script><script defer src="sidebar-items.js"></script><script defer src="../static.files/main-0795b7d26be81095.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../static.files/light-0f8c037637f9eb3e.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../static.files/dark-1097f8e92a01e3cf.css"><link rel="stylesheet" href="../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../witx/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../witx/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Bindgen</a></h2><div class="sidebar-elems"><section><h3><a href="#required-associated-types">Required Associated Types</a></h3><ul class="block"><li><a href="#associatedtype.Operand">Operand</a></li></ul><h3><a href="#required-methods">Required Methods</a></h3><ul class="block"><li><a href="#tymethod.allocate_space">allocate_space</a></li><li><a href="#tymethod.emit">emit</a></li><li><a href="#tymethod.finish_block">finish_block</a></li><li><a href="#tymethod.push_block">push_block</a></li></ul><h3><a href="#implementors">Implementors</a></h3></section><h2><a href="index.html">In witx</a></h2></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Trait <a href="index.html">witx</a>::<wbr><a class="trait" href="#">Bindgen</a><button id="copy-path" title="Copy item path to clipboard"><img src="../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../src/witx/abi.rs.html#392-445">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><pre class="rust item-decl"><code>pub trait Bindgen {
    type <a href="#associatedtype.Operand" class="associatedtype">Operand</a>;

    // Required methods
    fn <a href="#tymethod.emit" class="fn">emit</a>(
        &amp;mut self,
        inst: &amp;<a class="enum" href="enum.Instruction.html" title="enum witx::Instruction">Instruction</a>&lt;'_&gt;,
        operands: &amp;mut <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;Self::<a class="associatedtype" href="trait.Bindgen.html#associatedtype.Operand" title="type witx::Bindgen::Operand">Operand</a>&gt;,
        results: &amp;mut <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;Self::<a class="associatedtype" href="trait.Bindgen.html#associatedtype.Operand" title="type witx::Bindgen::Operand">Operand</a>&gt;
    );
<span class="item-spacer"></span>    fn <a href="#tymethod.allocate_space" class="fn">allocate_space</a>(&amp;mut self, slot: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>, ty: &amp;<a class="struct" href="struct.NamedType.html" title="struct witx::NamedType">NamedType</a>);
<span class="item-spacer"></span>    fn <a href="#tymethod.push_block" class="fn">push_block</a>(&amp;mut self);
<span class="item-spacer"></span>    fn <a href="#tymethod.finish_block" class="fn">finish_block</a>(&amp;mut self, operand: <a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;Self::<a class="associatedtype" href="trait.Bindgen.html#associatedtype.Operand" title="type witx::Bindgen::Operand">Operand</a>&gt;);
}</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Trait for language implementors to use to generate glue code between native
WebAssembly signatures and interface types signatures.</p>
<p>This is used as an implementation detail in interpreting the ABI between
interface types and wasm types. Eventually this will be driven by interface
types adapters themselves, but for now the ABI of a function dictates what
instructions are fed in.</p>
<p>Types implementing <code>Bindgen</code> are incrementally fed <code>Instruction</code> values to
generate code for. Instructions operate like a stack machine where each
instruction has a list of inputs and a list of outputs (provided by the
<code>emit</code> function).</p>
</div></details><h2 id="required-associated-types" class="small-section-header">Required Associated Types<a href="#required-associated-types" class="anchor">§</a></h2><div class="methods"><details class="toggle" open><summary><section id="associatedtype.Operand" class="method"><a class="srclink rightside" href="../src/witx/abi.rs.html#396">source</a><h4 class="code-header">type <a href="#associatedtype.Operand" class="associatedtype">Operand</a></h4></section></summary><div class="docblock"><p>The intermediate type for fragments of code for this type.</p>
<p>For most languages <code>String</code> is a suitable intermediate type.</p>
</div></details></div><h2 id="required-methods" class="small-section-header">Required Methods<a href="#required-methods" class="anchor">§</a></h2><div class="methods"><details class="toggle method-toggle" open><summary><section id="tymethod.emit" class="method"><a class="srclink rightside" href="../src/witx/abi.rs.html#406-411">source</a><h4 class="code-header">fn <a href="#tymethod.emit" class="fn">emit</a>(
    &amp;mut self,
    inst: &amp;<a class="enum" href="enum.Instruction.html" title="enum witx::Instruction">Instruction</a>&lt;'_&gt;,
    operands: &amp;mut <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;Self::<a class="associatedtype" href="trait.Bindgen.html#associatedtype.Operand" title="type witx::Bindgen::Operand">Operand</a>&gt;,
    results: &amp;mut <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;Self::<a class="associatedtype" href="trait.Bindgen.html#associatedtype.Operand" title="type witx::Bindgen::Operand">Operand</a>&gt;
)</h4></section></summary><div class="docblock"><p>Emit code to implement the given instruction.</p>
<p>Each operand is given in <code>operands</code> and can be popped off if ownership
is required. It’s guaranteed that <code>operands</code> has the appropriate length
for the <code>inst</code> given, as specified with <a href="enum.Instruction.html" title="enum witx::Instruction"><code>Instruction</code></a>.</p>
<p>Each result variable should be pushed onto <code>results</code>. This function must
push the appropriate number of results or binding generation will panic.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.allocate_space" class="method"><a class="srclink rightside" href="../src/witx/abi.rs.html#418">source</a><h4 class="code-header">fn <a href="#tymethod.allocate_space" class="fn">allocate_space</a>(&amp;mut self, slot: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>, ty: &amp;<a class="struct" href="struct.NamedType.html" title="struct witx::NamedType">NamedType</a>)</h4></section></summary><div class="docblock"><p>Allocates temporary space in linear memory indexed by <code>slot</code> with enough
space to store <code>ty</code>.</p>
<p>This is called when calling some wasm functions where a return pointer
is needed.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.push_block" class="method"><a class="srclink rightside" href="../src/witx/abi.rs.html#429">source</a><h4 class="code-header">fn <a href="#tymethod.push_block" class="fn">push_block</a>(&amp;mut self)</h4></section></summary><div class="docblock"><p>Enters a new block of code to generate code for.</p>
<p>This is currently exclusively used for constructing variants. When a
variant is constructed a block here will be pushed for each case of a
variant, generating the code necessary to translate a variant case.</p>
<p>Blocks are completed with <code>finish_block</code> below. It’s expected that <code>emit</code>
will always push code (if necessary) into the “current block”, which is
updated by calling this method and <code>finish_block</code> below.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.finish_block" class="method"><a class="srclink rightside" href="../src/witx/abi.rs.html#444">source</a><h4 class="code-header">fn <a href="#tymethod.finish_block" class="fn">finish_block</a>(&amp;mut self, operand: <a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;Self::<a class="associatedtype" href="trait.Bindgen.html#associatedtype.Operand" title="type witx::Bindgen::Operand">Operand</a>&gt;)</h4></section></summary><div class="docblock"><p>Indicates to the code generator that a block is completed, and the
<code>operand</code> specified was the resulting value of the block.</p>
<p>This method will be used to compute the value of each arm of lifting a
variant. The <code>operand</code> will be <code>None</code> if the variant case didn’t
actually have any type associated with it. Otherwise it will be <code>Some</code>
as the last value remaining on the stack representing the value
associated with a variant’s <code>case</code>.</p>
<p>It’s expected that this will resume code generation in the previous
block before <code>push_block</code> was called. This must also save the results
of the current block internally for instructions like <code>ResultLift</code> to
use later.</p>
</div></details></div><h2 id="implementors" class="small-section-header">Implementors<a href="#implementors" class="anchor">§</a></h2><div id="implementors-list"></div><script src="../implementors/witx/abi/trait.Bindgen.js" async></script></section></div></main></body></html>